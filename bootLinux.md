Запуск системы Astra Linux — это многоэтапный процесс, который имеет свои особенности из-за требований безопасности.

Процесс можно разделить на несколько ключевых фаз:

### 1. Аппаратная инициализация (BIOS/UEFI)
#### Что происходит:
- При включении питания компьютера управление получает микропрограмма BIOS или, в современных системах, UEFI.

#### Задачи:

- Проверка оборудования (POST - Power-On Self-Test).
- Инициализация процессора, памяти, дисков, устройств ввода/вывода.
- Поиск загрузочного устройства (жесткого диска, SSD, USB-накопителя) в соответствии с установленным порядком загрузки (Boot Order).
  
### 2. Работа загрузчика (GRUB 2)
#### Что происходит:
- После того как BIOS/UEFI нашел загрузочное устройство, он считывает и исполняет главный загрузочный запрос (MBR) или образ EFI, передавая управление загрузчику. В Astra Linux по умолчанию используется GRUB 2 (GRand Unified Bootloader).
  
#### Задачи GRUB:
- Отображает меню выбора (если установлено несколько ядер или ОС), где можно выбрать версию ядра или режим загрузки (например, "Безопасный режим").
- Загружает в память выбранное ядро Astra Linux (обычно файл vmlinuz-...) и начальный RAM-диск (initramfs/initrd).
- Передает управление ядру.
  
### 3. Инициализация ядра (Kernel)
#### Что происходит:
- Ядро "разворачивается" в оперативной памяти и начинает свою работу.

#### Задачи ядра:
- Декомпрессия:
    - Самораспаковка из сжатого образа.
- Инициализация оборудования:
    - Определяет и настраивает все процессоры, память, устройства, драйверы, которые необходимы для дальнейшей работы.
- Монтирование корневой файловой системы:
    - Ядро монтирует корневую файловую систему (/) в режиме "только для чтения" (ro). Для этого ему помогает initramfs, который содержит базовые драйверы (например, для SATA, NVMe, LVM, шифрования), без которых невозможно прочитать основной диск.
    - Запуск первого пользовательского процесса:
    - После завершения основной низкоуровневой инициализации ядро запускает процесс с PID (идентификатором процесса) 1. В Astra Linux, как и в большинстве современных дистрибутивов, это systemd.

### 4. Запуск systemd и системных служб
#### Что происходит:
- systemd становится главным менеджером, который управляет всеми остальными процессами в системе.

#### Задачи systemd:
- Монтирование файловых систем:
    - Перемонтирует корневую файловую систему в режим чтения-записи (rw) и монтирует все остальные файловые системы, указанные в /etc/fstab.
- Запуск системных служб (демонов):
    - Параллельно и в соответствии с зависимостями запускает службы: сеть, базы данных, системный журнал (syslog/rsyslog), cron и т.д.
- Запуск целевых уровней (targets):
    - Движется по цепочке целей, основной из которых является multi-user.target (многопользовательский режим без графического интерфейса) или graphical.target (режим с графическим интерфейсом).

### 5. Особенности Astra Linux: Загрузка в защищенном режиме
Это ключевое отличие от многих других дистрибутивов. Astra Linux разработана для работы с гостайной, поэтому безопасность встроена на всех этапах.

#### Загрузка в режиме "Усиленный парольный доступ" (уровень 2):
- После инициализации ядра и до запуска графической оболочки система останавливается на виртуальной консоли (tty1).
- На экране отображается не классический графический менеджер входа (DM), а текстовое приглашение на вход.
- Пользователь должен ввести свое учетное имя.
- Затем система требует ввести пароль учетной записи.

#### Важный этап:
- После этого система запрашивает пароль на жесткий диск, если он зашифрован (например, с помощью LUKS).

Только после успешной аутентификации на всех этапах systemd продолжает выполнение и запускает графическую оболочку (сеанс Fly или другой выбранный WM/DE).

#### Загрузка в режиме "Управляемый доступ" (уровень 4):
- Этот режим ближе к обычным ОС.
- Запускается графический менеджер входа (Display Manager), например, LightDM.
- Пользователь выбирает учетную запись и вводит пароль в графическом интерфейсе.
- Запрос пароля на шифрование диска также может быть интегрирован в этот процесс.

### 6. Запуск графической оболочки
#### Что происходит: 
- После успешного входа в систему запускается графический сервер (X.Org Server или, все чаще, Wayland) и выбранная пользователем среда рабочего стола.

#### В Astra Linux: 
- По умолчанию используется собственная оболочка Fly (форк GNOME) или другие доступные среды, такие как XFCE.

#### Краткая схема процесса:
- Включение ПК → BIOS/UEFI
- BIOS/UEFI → Загрузчик (GRUB 2)
- GRUB 2 → Ядро Linux + initramfs
- Ядро → Инициализация HW → Монтирование rootfs → systemd (PID 1)
- systemd → Запуск служб и целевых уровней
- Останов для аутентификации (в защищенном режиме): Запрос логина → Запрос пароля пользователя → Запрос пароля диска (если есть)
- После аутентификации → Запуск графического сервера и среды рабочего стола (Fly/GNOME/XFCE)
  
Готово! Пользователь получает полнофункциональный рабочий стол.
  
Этот многоступенчатый процесс, особенно с остановом на аутентификацию, обеспечивает высокий уровень защиты данных с самого момента включения компьютера, что является визитной карточкой Astra Linux.

